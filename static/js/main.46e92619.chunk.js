(this["webpackJsonprtc-test"]=this["webpackJsonprtc-test"]||[]).push([[0],{104:function(e,t,n){},105:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),i=n(11),a=n.n(i),o=(n(96),n(50)),s=n(13),u=n(51),l=n(52),d=n(62),j=n(61),b=n(24),h=n.n(b),O=n(43),f=n(22),x=n(31),p=n(153),v=n(154),m=n(155),g=n(156),y=n(157),k=n(158),w=n(173),C=n(152),S=n(150),R=n(151),T=n(168),I=n(2);function L(e){var t=e.open,n=e.message,c=e.label,r=e.setText,i=e.value,a=e.submit;return Object(I.jsxs)(w.a,{open:t,children:[Object(I.jsxs)(S.a,{children:[Object(I.jsx)(R.a,{children:n}),Object(I.jsx)(T.a,{label:c,type:"number",onChange:function(e){var t=Number(e.target.value);t>100&&(t=100),t<1&&(t=1),r(t)},inputProps:{min:1,max:100},value:i})]}),Object(I.jsx)(C.a,{children:Object(I.jsx)(p.a,{onClick:a,color:"primary",children:"\uc785\ub825"})})]})}var E=n(75),B=n(169),M=(Object(E.a)({overrides:{MuiGrid:{container:{height:"100%"}}},palette:{primary:{main:"#38BF87"},secondary:{main:"#ff1a1a"}}}),Object(B.a)((function(){return{roundButton:{borderRadius:"50%",width:"60px",height:"60px"}}}))),N=function(e){var t=e.connections,n=e.setConnections,c=e.setResolution,i=e.audio,a=e.video,o=e.toggleAudio,s=e.toggleVideo,u=e.initCall,l=e.localStream,d=e.foundLocal,j=e.isOpen,b=e.setIsOpen,h=M();return Object(I.jsxs)(r.a.Fragment,{children:[Object(I.jsx)("main",{children:Object(I.jsxs)(v.a,{container:!0,id:"await-main",spacing:10,children:[Object(I.jsx)(v.a,{item:!0,children:Object(I.jsxs)("div",{id:"await-video-container",children:[Object(I.jsx)("video",{id:"await-video",ref:l,autoPlay:!0}),Object(I.jsxs)("div",{id:"await-video-controls",children:[Object(I.jsx)(p.a,{variant:"contained",className:h.roundButton,onClick:o,children:i?Object(I.jsx)(m.a,{}):Object(I.jsx)(g.a,{})}),Object(I.jsx)(p.a,{variant:"contained",className:h.roundButton,onClick:s,children:a?Object(I.jsx)(y.a,{}):Object(I.jsx)(k.a,{})})]})]})}),Object(I.jsx)(v.a,{item:!0,className:h.awaitControls,children:Object(I.jsxs)(v.a,{container:!0,direction:"column",spacing:1,alignItems:"center",children:[Object(I.jsx)(v.a,{item:!0,children:Object(I.jsxs)("div",{id:"await-resoultion-controls",children:[Object(I.jsx)(p.a,{variant:"contained",onClick:function(){return c(0)},children:"qvga"}),Object(I.jsx)(p.a,{variant:"contained",onClick:function(){return c(1)},children:"vga"}),Object(I.jsx)(p.a,{variant:"contained",onClick:function(){return c(2)},children:"HD"}),Object(I.jsx)(p.a,{variant:"contained",onClick:function(){return c(3)},children:"fullHD"}),Object(I.jsx)(p.a,{variant:"contained",onClick:function(){return c(4)},children:"TV4k"}),Object(I.jsx)(p.a,{variant:"contained",onClick:function(){return c(5)},children:"cinema4K"}),Object(I.jsx)(p.a,{variant:"contained",onClick:function(){return c(5)},children:"8K"})]})}),Object(I.jsx)(v.a,{item:!0,children:Object(I.jsxs)(p.a,{onClick:function(){return b(!0)},children:["Connections: ",t]})}),Object(I.jsx)(v.a,{item:!0,children:Object(I.jsxs)(v.a,{container:!0,spacing:1,children:[Object(I.jsx)(v.a,{item:!0,children:Object(I.jsx)(p.a,{variant:"contained",className:h.roundButton,onClick:function(){return n(t+1)},disabled:t>=100,children:"+"})}),Object(I.jsx)(v.a,{item:!0,children:Object(I.jsx)(p.a,{variant:"contained",className:h.roundButton,onClick:function(){return n(t-1)},disabled:t<=1,children:"-"})})]})}),Object(I.jsx)(v.a,{item:!0,children:Object(I.jsx)(p.a,{variant:"contained",onClick:u,disabled:!d,children:"\uc9c0\uae08 \ucc38\uc5ec\ud558\uae30"})})]})})]})}),Object(I.jsx)(L,{open:j,message:"Peer \uc218 \uc785\ub825",label:"peer",setText:n,value:t,submit:function(){return b(!1)}})]})},V=n(58),A=n(66),D=n(175),P=n(170),F="rtc/SET_SETTINGS",H=Object(D.a)(F,(function(e){return e})),U=Object(P.a)(Object(V.a)({},F,(function(e,t){var n=t.payload;return Object(A.a)(Object(A.a)({},e),{},{setting:n})})),{setting:{connections:1,audio:!0,video:!0,resolution:{width:{exact:320},height:{exact:240}}}}),W=[{width:{exact:320},height:{exact:240}},{width:{exact:640},height:{exact:480}},{width:{exact:1280},height:{exact:720}},{width:{exact:1920},height:{exact:1080}},{width:{exact:3840},height:{exact:2160}},{width:{exact:4096},height:{exact:2160}},{width:{exact:7680},height:{exact:4320}}],q=Object(s.e)((function(e){var t=e.history,n=Object(x.c)((function(e){var t=e.rtc;return{connections:t.setting.connections,audio:t.setting.audio,video:t.setting.video,resolution:t.setting.resolution}})),r=n.connections,i=n.audio,a=n.video,o=n.resolution,s=Object(x.b)(),u=Object(c.useRef)(),l=Object(c.useState)(!1),d=Object(f.a)(l,2),j=d[0],b=d[1],p=Object(c.useState)(!1),v=Object(f.a)(p,2),m=v[0],g=v[1];Object(c.useEffect)((function(){y(o)}),[]);var y=function(){var e=Object(O.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u.current.srcObject&&(console.log("stop track"),u.current.srcObject.getTracks().forEach((function(e){e.stop()}))),e.next=4,navigator.mediaDevices.getUserMedia({audio:!0,video:t}).then((function(e){u.current.srcObject=e;var t=e.getVideoTracks()[0].getSettings(),n=document.getElementById("await-video-container");n.style.width="".concat(t.width,"px"),n.style.height="".concat(t.height,"px")}));case 4:b(!0),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("getUserMedia error",e.t0),b(!1);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(I.jsx)(N,{audio:i,video:a,toggleAudio:function(){u.current.srcObject.getAudioTracks()[0].enabled=!i,s(H({connections:r,video:a,audio:!i,resolution:o}))},toggleVideo:function(){u.current.srcObject.getVideoTracks()[0].enabled=!a,s(H({connections:r,audio:i,video:!a,resolution:o}))},initCall:function(){u.current.srcObject&&(console.log("stop track"),u.current.srcObject.getTracks().forEach((function(e){e.stop()})),u.current=null),t.push("./test")},connections:r,setConnections:function(e){return s(H({connections:e,audio:i,video:a,resolution:o}))},setResolution:function(e){s(H({connections:r,audio:!0,video:!0,resolution:W[e]})),y(W[e])},localStream:u,foundLocal:j,history:t,isOpen:m,setIsOpen:g})})),z=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(I.jsx)(q,{})}}]),n}(r.a.Component),G=n(165),J=n(166),K=n(167),_=n(174),Q=n(171),X=n(164),Y=n(159),Z=n(160),$=n(161),ee=n(163),te=n(162),ne=function(e){var t=e.tableHead,n=e.tableData;return Object(I.jsxs)(Y.a,{children:[Object(I.jsx)(Z.a,{children:Object(I.jsx)($.a,{children:t.map((function(e){return Object(I.jsx)(te.a,{children:e})}))})}),Object(I.jsx)(ee.a,{children:n.map((function(e){return Object(I.jsx)($.a,{children:e.map((function(e){return Object(I.jsx)(te.a,{children:e})}))})}))})]})};function ce(e){var t=e.open,n=e.messages,c=e.confirm,r=e.isSender,i=e.setIsSender,a={},o=[];return n["sender"===r?0:1].forEach((function(e){var t,n=[];for(t in o.push(e.id),e)n.push([t,e[t]]);a[e.id]=n})),Object(I.jsxs)(w.a,{open:t,fullWidth:!0,maxWidth:"xl",children:[Object(I.jsxs)(S.a,{children:[Object(I.jsxs)(_.a,{value:r,onChange:function(e){console.log("isSender",e.target.value,r),i(e.target.value)},children:[Object(I.jsx)(X.a,{value:"sender",label:"Sender",control:Object(I.jsx)(Q.a,{})}),Object(I.jsx)(X.a,{value:"receiver",label:"Receiver",control:Object(I.jsx)(Q.a,{})})]}),o.map((function(e){return Object(I.jsxs)("details",{children:[Object(I.jsx)("summary",{children:e}),Object(I.jsx)(ne,{tableHead:["parameter","value"],tableData:a[e]})]})}))]}),Object(I.jsx)(C.a,{children:Object(I.jsx)(p.a,{onClick:c,color:"primary",children:"\ud655\uc778"})})]})}var re=function(e){var t=e.audio,n=e.video,c=e.setConnections,i=e.toggleAudio,a=e.toggleVideo,o=e.toggleView,s=e.hangup,u=e.connections,l=e.localStreamRef,d=e.statsIsOpen,j=e.openStats,b=e.closeStats,h=e.statMessages,O=e.isSender,f=e.setIsSender,x=M();return Object(I.jsxs)(r.a.Fragment,{children:[Object(I.jsxs)("div",{id:"my-area",children:[Object(I.jsx)(G.a,{}),Object(I.jsxs)("p",{children:[" ",u]}),Object(I.jsx)(p.a,{onClick:function(){return c(u+1)},children:"+"}),Object(I.jsx)(p.a,{onClick:function(){return c(u-1)},children:"-"}),Object(I.jsx)("video",{id:"my-video",ref:l,autoPlay:!0})]}),Object(I.jsx)("main",{children:Object(I.jsxs)("div",{id:"call-main",children:[Object(I.jsx)("div",{id:"call-videos",children:Array.from({length:u},(function(e,t){return Object(I.jsx)("div",{className:"remote-container",id:"remote-container ".concat(t),children:Object(I.jsx)("video",{className:"remote-video",id:"remote-video ".concat(t),onClick:function(){return j(t)},autoPlay:!0})},t)}))}),Object(I.jsxs)(v.a,{container:!0,justify:"space-between",alignItems:"center",children:[Object(I.jsx)(v.a,{item:!0}),Object(I.jsx)(v.a,{item:!0,children:Object(I.jsxs)(v.a,{container:!0,spacing:2,children:[Object(I.jsx)(v.a,{item:!0,children:Object(I.jsx)(p.a,{variant:"contained",className:x.roundButton,onClick:i,children:t?Object(I.jsx)(m.a,{}):Object(I.jsx)(g.a,{})})}),Object(I.jsx)(v.a,{item:!0,children:Object(I.jsx)(p.a,{variant:"contained",className:x.roundButton,onClick:a,children:n?Object(I.jsx)(y.a,{}):Object(I.jsx)(k.a,{})})}),Object(I.jsx)(v.a,{item:!0,children:Object(I.jsx)(p.a,{variant:"contained",className:x.roundButton,onClick:s,children:Object(I.jsx)(J.a,{})})})]})}),Object(I.jsx)(v.a,{item:!0,children:Object(I.jsx)(p.a,{variant:"contained",className:x.roundButton,onClick:o,children:Object(I.jsx)(K.a,{})})})]})]})}),Object(I.jsx)(ce,{open:d,messages:h,confirm:b,isSender:O,setIsSender:f})]})},ie=Object(s.e)((function(e){var t=e.history,n=Object(x.c)((function(e){var t=e.rtc;return{connections:t.setting.connections,audio:t.setting.audio,video:t.setting.video,resolution:t.setting.resolution}})),r=n.connections,i=n.audio,a=n.video,o=n.resolution,s=Object(x.b)(),u=Object(c.useRef)(),l=Object(c.useRef)(Array.from({length:100},(function(){return{pcLocal:null,pcRemote:null}}))),d=Object(c.useRef)(Array.from({length:100},(function(){return null}))),j=Object(c.useState)(0),b=Object(f.a)(j,2),p=b[0],v=b[1],m=Object(c.useState)(0),g=Object(f.a)(m,2),y=g[0],k=g[1],w=Object(c.useState)("sidebar"),C=Object(f.a)(w,2),S=C[0],R=C[1],T=Object(c.useState)(!1),L=Object(f.a)(T,2),E=L[0],B=L[1],M=Object(c.useState)([[],[]]),N=Object(f.a)(M,2),V=N[0],A=N[1],D=Object(c.useState)(null),P=Object(f.a)(D,2),F=P[0],U=P[1],W=Object(c.useState)("sender"),q=Object(f.a)(W,2),z=q[0],G=q[1];Object(c.useEffect)((function(){return J(),window.addEventListener("resize",J),function(){window.removeEventListener("resize",J)}}),[]),Object(c.useEffect)((function(){ne(!1),_(),K()}),[r]),Object(c.useEffect)((function(){K()}),[S,y,p]);var J=function(){var e=document.getElementById("call-videos");v(e.offsetWidth),k(e.offsetHeight)},K=function(){for(var e,t,n=0;n<r;n++)e=document.getElementById("remote-video ".concat(n)),t=document.getElementById("remote-container ".concat(n)),p>y?(e.style.width="100%",e.style.height="auto"):(e.style.width="auto",e.style.height="100%"),"sidebar"===S?(t.style.display="block",t.style.position="absolute",0===n?(t.style.left=0,t.style.width="".concat(p-220,"px"),t.style.height="100%"):n>5?t.style.display="none":(t.style.right=0,t.style.width="218px",t.style.height="123px",t.style.top="".concat(123*Math.min(n-1,6)+64,"px"))):(t.style.display="block",t.style.top="auto",t.style.left="auto",t.style.right="auto",n>49&&(t.style.display="none"),t.style.position="relative",t.style.width="".concat(p/Math.ceil(Math.sqrt(Math.min(r,49))),"px"),t.style.height="".concat(y/Math.ceil(Math.sqrt(Math.min(r,49))),"px"))},_=function(){var e=Object(O.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({audio:i||!0,video:!a||o}).then((function(e){u.current.srcObject=e;e.getVideoTracks()[0].getSettings()}));case 3:u.current.srcObject.getAudioTracks()[0].enabled=i,u.current.srcObject.getVideoTracks()[0].enabled=a,Q(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("getUserMedia error",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),Q=function(){var e=Object(O.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=function(e){l.current[e].pcLocal=new RTCPeerConnection(null),l.current[e].pcRemote=new RTCPeerConnection(null),l.current[e].pcRemote.ontrack=function(t){return Z(t,e)},l.current[e].pcLocal.onicecandidate=function(t){return $(t,e)},l.current[e].pcRemote.onicecandidate=function(t){return ee(t,e)},u.current.srcObject.getTracks().forEach((function(t){return l.current[e].pcLocal.addTrack(t,u.current.srcObject)})),l.current[e].pcLocal.createOffer({offerToReceiveAudio:1,offerToReceiveVideo:1}).then((function(t){return Y(t,e)}),X)},n=0;n<r;n++)t(n);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function X(e){console.log("Failed to create session description: ".concat(e.toString()))}function Y(e,t){l.current[t].pcLocal.setLocalDescription(e),l.current[t].pcRemote.setRemoteDescription(e),l.current[t].pcRemote.createAnswer().then((function(e){return function(e,t){l.current[t].pcRemote.setLocalDescription(e),l.current[t].pcLocal.setRemoteDescription(e)}(e,t)}),X)}function Z(e,t){if(d.current[t]!==e.streams[0]){d.current[t]=e.streams[0];var n=document.getElementById("remote-video ".concat(t));n&&(n.srcObject=d.current[t]),console.log("pc".concat(t,": received remote stream"))}else console.log("test failed!")}function $(e,t){te(e.candidate,l.current[t].pcRemote,"pc".concat(t,": "),"local")}function ee(e,t){te(e.candidate,l.current[t].pcLocal,"pc".concat(t,": "),"remote")}function te(e,t,n,c){t.addIceCandidate(e)}function ne(e){for(var n=0;n<r;n++)l.current[n].pcLocal&&l.current[n].pcLocal.close(),l.current[n].pcRemote&&l.current[n].pcRemote.close(),l.current[n].pcLocal=null,l.current[n].pcRemote=null;e&&(u.current.srcObject&&(u.current.srcObject.getTracks().forEach((function(e){e.stop()})),u.current=null),s(H({connections:r,audio:!0,video:!0,resolution:o})),t.push("/"))}return Object(I.jsx)(re,{audio:i,video:a,setConnections:function(e){return s(H({connections:e,audio:i,video:a,resolution:o}))},toggleAudio:function(){u.current.srcObject.getAudioTracks()[0].enabled=!i,s(H({connections:r,video:a,audio:!i,resolution:o}))},toggleVideo:function(){u.current.srcObject.getVideoTracks()[0].enabled=!a,s(H({connections:r,audio:i,video:!a,resolution:o}))},toggleView:function(){R("sidebar"===S?"tiles":"sidebar")},hangup:function(){return ne(!0)},connections:r,localStreamRef:u,remoteStreamRefs:d,statsIsOpen:E,openStats:function(e){return function(e){F&&clearInterval(F);var t=setInterval(Object(O.a)(h.a.mark((function t(){var n,c,r;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=["",""],!l.current[e]||!l.current[e].pcLocal){t.next=6;break}return t.next=4,l.current[e].pcLocal.getStats(null).then((function(e){return e}),(function(e){return e.toString()}));case 4:c=t.sent,n[0]=c;case 6:if(!l.current[e]||!l.current[e].pcRemote){t.next=11;break}return t.next=9,l.current[e].pcRemote.getStats(null).then((function(e){return e}),(function(e){return e.toString()}));case 9:r=t.sent,n[1]=r;case 11:A(n);case 12:case"end":return t.stop()}}),t)}))),1e3);U(t),B(!0)}(e)},closeStats:function(){clearInterval(F),B(!1),U(null)},statMessages:V,isSender:z,setIsSender:G})})),ae=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(I.jsx)(ie,{})}}]),n}(r.a.Component);n(104);var oe=function(){return Object(I.jsxs)(o.a,{basename:"/",hashType:"noslash",children:[Object(I.jsx)(s.a,{exact:!0,path:"/",component:z}),Object(I.jsx)(s.a,{exact:!0,path:"/test",component:ae})]})},se=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,177)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),c(e),r(e),i(e),a(e)}))},ue=n(34),le=Object(ue.combineReducers)({rtc:U}),de=function(e,t){return le(e,t)},je=n(74),be=Object(ue.createStore)(de,Object(je.composeWithDevTools)());a.a.render(Object(I.jsx)(x.a,{store:be,children:Object(I.jsx)(r.a.StrictMode,{children:Object(I.jsx)(oe,{})})}),document.getElementById("root")),se()},96:function(e,t,n){}},[[105,1,2]]]);
//# sourceMappingURL=main.46e92619.chunk.js.map