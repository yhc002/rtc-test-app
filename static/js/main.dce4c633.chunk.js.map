{"version":3,"sources":["components/popups/TextInputPopup.js","MuiTheme.js","components/HomeUI.js","modules/rtc.js","lib/constraints.js","containers/HomeForm.js","pages/Home.js","components/TestUI.js","containers/TestForm.js","pages/Test.js","App.js","reportWebVitals.js","modules/index.js","index.js"],"names":["TextfieldPopup","open","message","label","setText","value","submit","Dialog","DialogContent","DialogContentText","type","onChange","e","val","Number","target","inputProps","min","max","DialogActions","Button","onClick","color","useStyles","createMuiTheme","overrides","MuiGrid","container","height","palette","primary","main","secondary","makeStyles","roundButton","borderRadius","width","HomeUI","connections","setConnections","setResolution","audio","video","toggleAudio","toggleVideo","initCall","localStream","isOpen","foundLocal","setIsOpen","classes","Fragment","Grid","id","spacing","item","ref","autoPlay","variant","className","Mic","MicOff","Videocam","VideocamOff","awaitControls","direction","alignItems","disabled","SET_SETTINGS","setSettings","createAction","settings","rtc","handleActions","state","setting","payload","resolution","exact","videoConstraints","withRouter","history","useSelector","dispatch","useDispatch","useRef","useState","setFoundLocal","useEffect","getMedia","res","a","current","srcObject","console","log","getTracks","forEach","track","stop","navigator","mediaDevices","getUserMedia","then","stream","getVideoTracks","getSettings","controls","document","getElementById","style","getAudioTracks","enabled","push","idx","Home","React","Component","TestUI","toggleView","hangup","localStreamRef","openStats","statsIsOpen","closeStats","statMessages","isSender","setIsSender","People","Array","from","length","_","i","justify","CallEnd","Layers","isHost","setIsHost","RTCObjects","socket","setSocket","remoteRefs","areaWidth","setAreaWidth","areaHeight","setAreaHeight","view","setView","setStatsIsOpen","setStatMessages","statInterval","setStatInterval","resizeWindow","window","addEventListener","init","io","removeEventListener","resizeVideos","configSocket","area","offsetWidth","offsetHeight","vid","vidContainer","display","position","left","right","top","Math","ceil","sqrt","room","emit","on","data","signalData","setRemoteDescription","candidate","addIceCandidate","acceptCall","closeRTC","once","result","error","RTCPeerConnection","config","iceServers","urls","credential","username","onicecandidate","event","iceCallbackLocal","addTrack","createOffer","offerToReceiveAudio","offerToReceiveVideo","onCreateOffer","onCreateSessionDescriptionError","ontrack","gotRemoteStream","remoteSignal","iceCallbackRemote","createAnswer","onCreateAnswer","toString","desc","setLocalDescription","streams","close","shouldLeave","adjustConnection","remoteStreamRefs","clearInterval","interval","setInterval","messages","pcLocal","getStats","results","err","localStat","pcRemote","remoteStat","Test","App","basename","process","hashType","path","component","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","appReducer","combineReducers","rootReducer","action","store","createStore","composeWithDevTools","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.dce4c633.chunk.js","sourcesContent":["import Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport Button from '@material-ui/core/Button'\r\nimport Textfield from '@material-ui/core/Textfield';\r\n\r\nexport default function TextfieldPopup({ open, message, label, setText, value, submit }) {\r\n    const handleInput = (e) => {\r\n        let val = Number(e.target.value);\r\n        if(val>100) {\r\n            val=100;\r\n        }\r\n        if(val<1) {\r\n            val=1;\r\n        }\r\n        setText(val);\r\n    }\r\n\r\n    return(\r\n        <Dialog\r\n            open={open}\r\n        >\r\n            <DialogContent>\r\n                <DialogContentText>\r\n                    {message}\r\n                </DialogContentText>\r\n                <Textfield\r\n                    label={label}\r\n                    type=\"number\"\r\n                    onChange={handleInput}\r\n                    inputProps={{min:1,max:100}}\r\n                    value={value}\r\n                />\r\n            </DialogContent>\r\n            <DialogActions>\r\n                <Button onClick={submit} color=\"primary\">\r\n                    입력\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n    );\r\n}","import { createMuiTheme } from '@material-ui/core/styles'\r\nimport { makeStyles } from '@material-ui/styles';\r\n\r\nconst themePalete = createMuiTheme({\r\n  overrides: {\r\n    MuiGrid: {\r\n      container: {\r\n        height: \"100%\"\r\n      }\r\n    }\r\n  },\r\n  palette: {\r\n    primary: { main: \"#38BF87\" },\r\n    secondary: { main: \"#ff1a1a\" },\r\n  }\r\n})\r\n\r\nexport const useStyles = makeStyles(() => ({\r\n    roundButton: {\r\n        borderRadius: \"50%\",\r\n        width: \"60px\",\r\n        height: \"60px\",\r\n    }\r\n}));\r\n\r\nexport default themePalete;","import React from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport { Videocam, VideocamOff, Mic, MicOff } from '@material-ui/icons';\r\nimport TextInputPopup from './popups/TextInputPopup';\r\nimport { useStyles } from '../MuiTheme';\r\n\r\nconst HomeUI = ({\r\n    connections, setConnections, setResolution, audio, video, toggleAudio, toggleVideo, initCall, localStream, foundLocal, isOpen, setIsOpen \r\n}) => {\r\n    const classes = useStyles();\r\n\r\n    return(\r\n        <React.Fragment>\r\n            <main>\r\n                <Grid container id=\"await-main\" spacing={10}>\r\n                    <Grid item>\r\n                        <div id=\"await-video-container\">\r\n                            <video id=\"await-video\" ref={localStream} autoPlay/>\r\n                            <div id='await-video-controls'>\r\n                                <Button variant=\"contained\" className={classes.roundButton} onClick={toggleAudio}>\r\n                                    { audio ? <Mic /> : <MicOff /> }\r\n                                </Button>\r\n                                <Button variant=\"contained\" className={classes.roundButton} onClick={toggleVideo}>\r\n                                    { video? <Videocam /> : <VideocamOff /> }\r\n                                </Button>\r\n                            </div>\r\n                        </div>\r\n                    </Grid>\r\n                    <Grid item className={classes.awaitControls}>\r\n                        <Grid container direction=\"column\" spacing={1} alignItems=\"center\">\r\n                            <Grid item>\r\n                                <div id=\"await-resoultion-controls\">\r\n                                    <Button variant=\"contained\" onClick={()=>setResolution(0)}>qvga</Button>\r\n                                    <Button variant=\"contained\" onClick={()=>setResolution(1)}>vga</Button>\r\n                                    <Button variant=\"contained\" onClick={()=>setResolution(2)}>HD</Button>\r\n                                    <Button variant=\"contained\" onClick={()=>setResolution(3)}>fullHD</Button>\r\n                                    <Button variant=\"contained\" onClick={()=>setResolution(4)}>TV4k</Button>\r\n                                    <Button variant=\"contained\" onClick={()=>setResolution(5)}>cinema4K</Button>\r\n                                    <Button variant=\"contained\" onClick={()=>setResolution(5)}>8K</Button>\r\n                                </div> \r\n                            </Grid>\r\n                            <Grid item>\r\n                                <Button onClick={()=>setIsOpen(true)}>Connections: {connections}</Button>\r\n                            </Grid>\r\n                            <Grid item>\r\n                                <Grid container spacing={1}>\r\n                                    <Grid item>\r\n                                        <Button variant=\"contained\" className={classes.roundButton} onClick={()=>setConnections(connections+1)} disabled={connections>=100}>\r\n                                            +\r\n                                        </Button>\r\n                                    </Grid>\r\n                                    <Grid item>\r\n                                        <Button variant=\"contained\" className={classes.roundButton} onClick={()=>setConnections(connections-1)} disabled={connections<=1}>\r\n                                            -\r\n                                        </Button>\r\n                                    </Grid>\r\n                                </Grid>\r\n                            </Grid>\r\n                            <Grid item>\r\n                                <Button variant=\"contained\" onClick={initCall}>\r\n                                    지금 참여하기\r\n                                </Button>\r\n                            </Grid>\r\n                        </Grid>\r\n                    </Grid>\r\n                </Grid>\r\n            </main>\r\n            <TextInputPopup\r\n                open={isOpen}\r\n                message=\"Peer 수 입력\"\r\n                label=\"peer\"\r\n                setText={setConnections}\r\n                value={connections}\r\n                submit={()=>setIsOpen(false)}\r\n            />\r\n        </React.Fragment>\r\n    )\r\n}\r\n\r\nexport default HomeUI;","import { createAction, handleActions } from 'redux-actions';\r\n\r\nconst SET_SETTINGS = \"rtc/SET_SETTINGS\";\r\n\r\nconst initialState = {\r\n    setting: {\r\n        connections: 1,\r\n        audio: true,\r\n        video: true,\r\n        resolution: {width: {exact: 320}, height: {exact: 240}}, \r\n    },\r\n}\r\n\r\nexport const setSettings = createAction(SET_SETTINGS, settings => settings);\r\n\r\nconst rtc = handleActions(\r\n    {\r\n        [SET_SETTINGS]: (state, { payload: setting })=>({\r\n            ...state,\r\n            setting,\r\n        }),\r\n    },\r\n    initialState,\r\n);\r\n\r\nexport default rtc;","const qvgaConstraints = { width: {exact: 320}, height: {exact: 240} };\r\n\r\nconst vgaConstraints = { width: {exact: 640}, height: {exact: 480} };\r\n\r\nconst hdConstraints =  { width: {exact: 1280}, height: {exact: 720} };\r\n\r\nconst fullHdConstraints = { width: {exact: 1920}, height: {exact: 1080} };\r\n\r\nconst televisionFourKConstraints = { width: {exact: 3840}, height: {exact: 2160} };\r\n\r\nconst cinemaFourKConstraints = { width: {exact: 4096}, height: {exact: 2160} };\r\n\r\nconst eightKConstraints = { width: {exact: 7680}, height: {exact: 4320} };\r\n\r\nexport const videoConstraints = [qvgaConstraints, vgaConstraints, hdConstraints, fullHdConstraints, televisionFourKConstraints, cinemaFourKConstraints, eightKConstraints]\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { withRouter } from 'react-router-dom';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport Home from '../components/HomeUI'\r\nimport { setSettings } from '../modules/rtc';\r\nimport {videoConstraints } from '../lib/constraints';\r\n\r\nconst HomeForm = ({ history }) => {\r\n    const { connections, audio, video, resolution } = useSelector(({ rtc }) => ({\r\n        connections: rtc.setting.connections,\r\n        audio: rtc.setting.audio,\r\n        video: rtc.setting.video,\r\n        resolution: rtc.setting.resolution,\r\n    }));\r\n    const dispatch = useDispatch();\r\n\r\n    const localStream=useRef();\r\n    const [foundLocal, setFoundLocal] = useState(false);\r\n    const [isOpen,setIsOpen] = useState(false);\r\n\r\n    useEffect(()=>{getMedia(resolution)},[]);\r\n\r\n    const getMedia = async (res) => {\r\n        try {\r\n            if(localStream.current.srcObject) {\r\n                console.log(\"stop track\")\r\n                localStream.current.srcObject.getTracks().forEach(track => {\r\n                    track.stop();\r\n                });\r\n            }\r\n\r\n            await navigator.mediaDevices.getUserMedia({ audio: true, video: res }).then(stream => {\r\n                localStream.current.srcObject = stream;\r\n                const track = stream.getVideoTracks()[0]\r\n                const settings = track.getSettings();\r\n                const controls = document.getElementById('await-video-container');\r\n                controls.style.width = `${settings.width}px`;\r\n                controls.style.height = `${settings.height}px`;\r\n            });\r\n            setFoundLocal(true);\r\n        } catch (e) {\r\n            console.log(\"getUserMedia error\",e)\r\n            setFoundLocal(false);\r\n        }\r\n    }\r\n\r\n\r\n    const initCall = () => {\r\n        if(localStream.current.srcObject) {\r\n            console.log(\"stop track\")\r\n            localStream.current.srcObject.getTracks().forEach(track => {\r\n                track.stop();\r\n            });\r\n            localStream.current=null;\r\n        }\r\n        history.push('./test');\r\n    }\r\n\r\n    const toggleAudio = () => {\r\n        localStream.current.srcObject.getAudioTracks()[0].enabled = !audio;\r\n        dispatch(setSettings({ connections, video, audio: !audio, resolution }));\r\n    }\r\n\r\n    const toggleVideo = () => {\r\n        localStream.current.srcObject.getVideoTracks()[0].enabled = !video;\r\n        dispatch(setSettings({ connections, audio, video: !video, resolution }));\r\n    }\r\n\r\n    const setResolution = (idx) => {\r\n        dispatch(setSettings({ connections, audio: true, video: true, resolution: videoConstraints[idx] }));\r\n        getMedia(videoConstraints[idx]);\r\n    }\r\n\r\n    return (\r\n        <Home\r\n            audio={audio}\r\n            video={video}\r\n            toggleAudio={toggleAudio}\r\n            toggleVideo={toggleVideo}\r\n            initCall={initCall}\r\n            connections={connections}\r\n            setConnections={(val)=>dispatch(setSettings({ connections: val, audio, video, resolution }))}\r\n            setResolution={setResolution}\r\n            localStream={localStream}\r\n            foundLocal={foundLocal}\r\n            history={history} \r\n            isOpen={isOpen}\r\n            setIsOpen={setIsOpen}\r\n        />\r\n    );\r\n};\r\n\r\nexport default withRouter(HomeForm);","import React from 'react';\r\nimport HomeForm from '../containers/HomeForm';\r\n\r\nexport default class Home extends React.Component {\r\n\r\n    render() {\r\n        return (\r\n            <HomeForm />\r\n        );\r\n    }\r\n}","import React from 'react';\r\nimport Button from '@material-ui/core/Button'\r\nimport Grid from '@material-ui/core/Grid';\r\nimport { Videocam, VideocamOff, Mic, MicOff, CallEnd, Layers, People } from \"@material-ui/icons\";\r\nimport { useStyles } from '../MuiTheme';\r\nimport StatsPopup from './popups/StatsPopup'; \r\n\r\nconst TestUI = ({\r\n    audio, video, setConnections, toggleAudio, toggleVideo, toggleView, hangup, connections, localStreamRef, statsIsOpen, openStats, closeStats, statMessages, isSender, setIsSender,\r\n}) => {\r\n    const classes = useStyles();\r\n    \r\n    return(\r\n        <React.Fragment>\r\n            <div id='my-area'>\r\n                <People />\r\n                <p> {connections}</p>\r\n                <Button onClick={()=>setConnections(connections+1)}>+</Button>\r\n                <Button onClick={()=>setConnections(connections-1)}>-</Button>\r\n                <video id=\"my-video\" ref={localStreamRef} autoPlay={true}  />\r\n            </div>\r\n            <main>\r\n                <div id=\"call-main\">\r\n                    <div id=\"call-videos\">\r\n                        {\r\n                            Array.from({ length:connections },(_,i) => \r\n                                <div key={i} className=\"remote-container\" id={`remote-container ${i}`}>\r\n                                    <video className=\"remote-video\" id={`remote-video ${i}`} onClick={()=>openStats(i)} autoPlay/>\r\n                                </div>\r\n                            )\r\n                        }\r\n                    </div> \r\n                    <Grid container justify=\"space-between\" alignItems=\"center\">\r\n                        <Grid item/>\r\n                        <Grid item>\r\n                            <Grid container spacing={2}>\r\n                                <Grid item>\r\n                                    <Button variant=\"contained\" className={classes.roundButton} onClick={toggleAudio}>\r\n                                        { audio ? <Mic /> : <MicOff /> }\r\n                                    </Button>\r\n                                </Grid>\r\n                                <Grid item>\r\n                                    <Button variant=\"contained\" className={classes.roundButton} onClick={toggleVideo}>\r\n                                        { video? <Videocam /> : <VideocamOff /> }\r\n                                    </Button>\r\n                                </Grid>\r\n                                <Grid item>\r\n                                    <Button variant=\"contained\" className={classes.roundButton} onClick={hangup}>\r\n                                        <CallEnd />\r\n                                    </Button>\r\n                                </Grid>\r\n                            </Grid>\r\n                        </Grid>\r\n                        <Grid item>\r\n                            <Button variant=\"contained\" className={classes.roundButton} onClick={toggleView}>\r\n                                <Layers />\r\n                            </Button>\r\n                        </Grid>  \r\n                    </Grid>\r\n                </div>\r\n            </main>\r\n            {/* <StatsPopup\r\n                open={statsIsOpen}\r\n                messages={statMessages}\r\n                confirm={closeStats}\r\n                isSender={isSender}\r\n                setIsSender={setIsSender}\r\n            /> */}\r\n        </React.Fragment>\r\n    )\r\n}\r\n\r\nexport default TestUI;","import React, { useEffect, useState, useRef } from 'react';\r\nimport { withRouter } from 'react-router-dom';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport io from \"socket.io-client\";\r\nimport Test from '../components/TestUI'\r\nimport { setSettings } from '../modules/rtc';\r\n\r\nconst TestForm = ({ history }) => {\r\n    const { connections, audio, video, resolution } = useSelector(({ rtc }) => ({\r\n        connections: rtc.setting.connections,\r\n        audio: rtc.setting.audio,\r\n        video: rtc.setting.video,\r\n        resolution: rtc.setting.resolution,\r\n    }));\r\n\r\n    const room=1;\r\n    const [isHost, setIsHost] = useState(false);\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    const localStream=useRef();\r\n    const RTCObjects =useRef(Array.from({ length: 100 },() => null));\r\n\r\n    const [socket, setSocket] = useState(null);\r\n\r\n    const remoteRefs = useRef(Array.from({ length: 100 },() => null))\r\n\r\n    const [areaWidth, setAreaWidth] = useState(0);\r\n    const [areaHeight, setAreaHeight] = useState(0);\r\n    const [view,setView] = useState('sidebar')\r\n\r\n    const [statsIsOpen, setStatsIsOpen] = useState(false);\r\n    const [statMessages, setStatMessages] = useState([[],[]]);\r\n    const [statInterval, setStatInterval] = useState(null);\r\n    const [isSender, setIsSender] = useState(\"sender\");\r\n\r\n    useEffect(() => {\r\n        resizeWindow();\r\n        window.addEventListener('resize', resizeWindow);\r\n        init();\r\n        setSocket(io(\"https://rtc-test-app.herokuapp.com/\"));\r\n        return () => { // cleanup\r\n            window.removeEventListener('resize', resizeWindow);\r\n        }\r\n      }, []);\r\n\r\n    useEffect(() => {\r\n        resizeVideos();\r\n    },[connections]);\r\n\r\n    //initiate after socket is set\r\n    useEffect(() => {\r\n        if(socket)\r\n        {\r\n            configSocket(room)\r\n        }\r\n    }, [socket])\r\n\r\n    useEffect(() => {\r\n        resizeVideos();\r\n    },[view, areaHeight, areaWidth])\r\n\r\n    const resizeWindow = () => {\r\n        const area = document.getElementById('call-videos');\r\n        setAreaWidth(area.offsetWidth);\r\n        setAreaHeight(area.offsetHeight);\r\n    }\r\n\r\n    const resizeVideos = () => {\r\n        let vid;\r\n        let vidContainer;\r\n        for(let idx=0;idx<connections;idx++) {\r\n            vid = document.getElementById(`remote-video ${idx}`);\r\n            vidContainer = document.getElementById(`remote-container ${idx}`)\r\n            if(areaWidth>areaHeight) {\r\n                vid.style.width=\"100%\";\r\n                vid.style.height=\"auto\";\r\n            } else {\r\n                vid.style.width=\"auto\";\r\n                vid.style.height=\"100%\";\r\n            }\r\n            if(view===\"sidebar\") {\r\n                vidContainer.style.display=\"block\";\r\n                vidContainer.style.position=\"absolute\";\r\n                if(idx===0){\r\n                    vidContainer.style.left=0;\r\n                    vidContainer.style.width=`${areaWidth-220}px`; \r\n                    vidContainer.style.height=\"100%\";\r\n                } else if(idx>5){\r\n                    vidContainer.style.display=\"none\";\r\n                } else {\r\n                    vidContainer.style.right=0;\r\n                    vidContainer.style.width=\"218px\";\r\n                    vidContainer.style.height=\"123px\";\r\n                    vidContainer.style.top=`${123*Math.min(idx-1,6)+64}px`\r\n                }\r\n            } else {\r\n                vidContainer.style.display=\"block\";\r\n                vidContainer.style.top=\"auto\";\r\n                vidContainer.style.left=\"auto\";\r\n                vidContainer.style.right=\"auto\";\r\n                if(idx>49){\r\n                    vidContainer.style.display=\"none\";\r\n                }\r\n                vidContainer.style.position=\"relative\";\r\n                vidContainer.style.width=`${areaWidth/Math.ceil(Math.sqrt(Math.min(connections,49)))}px`;\r\n                vidContainer.style.height=`${areaHeight/Math.ceil(Math.sqrt(Math.min(connections,49)))}px`\r\n            }\r\n        }\r\n    }\r\n\r\n    const init = async () => {\r\n        try {\r\n            await navigator.mediaDevices.getUserMedia({ audio: audio || true, video: video ? resolution : true }).then(stream => {\r\n                localStream.current.srcObject = stream;\r\n            });\r\n            localStream.current.srcObject.getAudioTracks()[0].enabled = audio;\r\n            localStream.current.srcObject.getVideoTracks()[0].enabled = video;\r\n        } catch (e) {\r\n            console.log(\"getUserMedia error\",e)\r\n        }\r\n    }\r\n\r\n    //attempt to create/enter room\r\n    const configSocket = (room) => {\r\n        try{\r\n            //emit message requesting to enter/create room\r\n            socket.emit(\"enterRoom\", room);\r\n            //procedure to handle situation where an opponent entered the room\r\n            socket.on(\"joined\",()=>{\r\n                setIsHost(true);\r\n                for(let i=0; i<connections; i++) {\r\n                    initCall(i);\r\n                }\r\n                //handle answer message\r\n                socket.on(\"signal-to-caller\", data => {\r\n                    if(data.signalData.type === \"answer\") {\r\n                        RTCObjects.current[data.idx].setRemoteDescription(data.signalData);\r\n                        console.log(\"caller received answer\", data)\r\n                    } else if (data.signalData.candidate) {\r\n                        RTCObjects.current[data.idx].addIceCandidate(data.signalData);\r\n                        console.log(\"caller received candidate\", data)\r\n                    } \r\n                });\r\n            });\r\n            //handle offer received\r\n            socket.on(\"offer-to-callee\", (data) => {\r\n                console.log(\"callee received offer\", data)\r\n                acceptCall(data.signalData, data.idx);\r\n                //handle candidate messages\r\n                socket.on(\"candidate-to-callee\", (data) => {\r\n                    console.log(\"callee received candidate\", data)\r\n                    RTCObjects.current[data.idx].addIceCandidate(data.signalData);\r\n                });\r\n            });\r\n            socket.on(\"close\",i => closeRTC(i));\r\n            //handle ending phone call\r\n            socket.on(\"end\",()=>{\r\n                hangup(false);\r\n            });\r\n            socket.once(\"joinResult\",(result)=>{\r\n                console.log('joinResult',result);\r\n            });\r\n        } catch(error){\r\n            console.log(\"room enter error\", error);\r\n        }\r\n    }\r\n\r\n    const initCall = async (i) => {\r\n        RTCObjects.current[i] = new RTCPeerConnection({\r\n            config: {\r\n                iceServers: [{urls: ['turn:10.186.117.86:3478?transport=udp'], credential: '1234', username: 'test'}],\r\n            },\r\n        });\r\n        RTCObjects.current[i].onicecandidate = (event)=>iceCallbackLocal(event, i);\r\n        if(localStream.current && localStream.current.srcObject) {\r\n            localStream.current.srcObject.getTracks().forEach(track => RTCObjects.current[i].addTrack(track, localStream.current.srcObject));\r\n        }\r\n        RTCObjects.current[i]\r\n            .createOffer({ offerToReceiveAudio: 1, offerToReceiveVideo: 1 })\r\n            .then((event)=>onCreateOffer(event,i), onCreateSessionDescriptionError);\r\n\r\n        RTCObjects.current[i].ontrack = (event)=>gotRemoteStream(event, i);\r\n    }\r\n\r\n    const acceptCall = async (remoteSignal, i) => {\r\n        RTCObjects.current[i] = new RTCPeerConnection({\r\n            config: {\r\n                iceServers: [{urls: ['turn:10.186.117.86:3478?transport=udp'], credential: '1234', username: 'test'}],\r\n            },\r\n        });\r\n        RTCObjects.current[i].onicecandidate = (event)=>iceCallbackRemote(event, i);\r\n        if(localStream.current && localStream.current.srcObject) {\r\n            localStream.current.srcObject.getTracks().forEach(track => RTCObjects.current[i].addTrack(track, localStream.current.srcObject));\r\n        }\r\n        \r\n        RTCObjects.current[i].setRemoteDescription(remoteSignal);\r\n\r\n        RTCObjects.current[i].createAnswer().then((event)=>onCreateAnswer(event, i), onCreateSessionDescriptionError);\r\n        RTCObjects.current[i].ontrack = (event)=>gotRemoteStream(event, i);\r\n    }\r\n\r\n    function onCreateSessionDescriptionError(error) {\r\n        console.log(`Failed to create session description: ${error.toString()}`);\r\n    }\r\n    \r\n    function onCreateOffer(desc, idx) {\r\n        RTCObjects.current[idx].setLocalDescription(desc);\r\n        socket.emit(\"caller-to-server\", { room, signalData: desc, idx });\r\n        console.log('create offer', desc);\r\n    }\r\n      \r\n    function onCreateAnswer(desc, idx) {\r\n        console.log('create answer');\r\n        RTCObjects.current[idx].setLocalDescription(desc);\r\n        socket.emit(\"callee-to-server\", { room, signalData: desc, idx });\r\n    }\r\n\r\n    function gotRemoteStream(e, idx) {\r\n        if (remoteRefs.current[idx] !== e.streams[0]) {\r\n            remoteRefs.current[idx] = e.streams[0];\r\n            const vid = document.getElementById(`remote-video ${idx}`);\r\n            if(vid) {\r\n                vid.srcObject = remoteRefs.current[idx];\r\n                console.log(`pc${idx}: set remote stream as srcObject`);\r\n            } else {\r\n                console.log(`pc${idx}: set fail remote stream`, vid);\r\n            }\r\n        } else {\r\n            console.log(`pc${idx}: failed to receive remote stream`)\r\n        }\r\n    }\r\n\r\n    function iceCallbackLocal(event, idx) {\r\n        socket.emit(\"caller-to-server\", { room, signalData: event.candidate, idx });\r\n    }\r\n      \r\n    function iceCallbackRemote(event, idx) {\r\n        socket.emit(\"callee-to-server\", { room, signalData: event.candidate, idx });\r\n    }\r\n\r\n    const closeRTC = (i) => {\r\n        if(RTCObjects.current[i]) {\r\n            RTCObjects.current[i].close();\r\n            RTCObjects.current[i] = null;\r\n        }\r\n        if(isHost) {\r\n            socket.emit(\"close\",room,i);\r\n        }//if host\r\n    }\r\n\r\n    const hangup = (shouldLeave) => {\r\n        for(let i=0;i<connections;i++) {\r\n            closeRTC(i);\r\n        }\r\n        if(shouldLeave) {\r\n            if(localStream.current && localStream.current.srcObject) {\r\n                localStream.current.srcObject.getTracks().forEach(track => {\r\n                    track.stop();\r\n                });\r\n                localStream.current=null;\r\n            }\r\n            if(socket) {\r\n                console.log(\"should disconnect socket\")\r\n                socket.emit(\"leaveRoom\", room);\r\n                // socket.disconnect();\r\n                dispatch(setSettings({ connections, audio: true, video: true, resolution }));\r\n            }\r\n            history.push('/')\r\n        } \r\n    }\r\n\r\n    const adjustConnection = (val) => {\r\n        if(val>connections) {\r\n            for(let i=connections;i<val;i++) {\r\n                initCall(i);\r\n            }\r\n        } else {\r\n            for(let i=val;i<connections;i++) {\r\n                closeRTC(i);\r\n            }\r\n        }\r\n        dispatch(setSettings({ connections: val, audio, video, resolution }));\r\n    }\r\n\r\n    const toggleAudio = () => {\r\n        if(localStream.current.srcObject) {\r\n            localStream.current.srcObject.getAudioTracks()[0].enabled = !audio;\r\n            dispatch(setSettings({ connections, video, audio: !audio, resolution }));\r\n        }\r\n    }\r\n\r\n    const toggleVideo = () => {\r\n        if(localStream.current.srcObject) {\r\n            localStream.current.srcObject.getVideoTracks()[0].enabled = !video;\r\n            dispatch(setSettings({ connections, audio, video: !video, resolution }));\r\n        }\r\n    }\r\n\r\n    const toggleView = () => {\r\n        if(view === \"sidebar\"){\r\n            setView(\"tiles\")\r\n        } else {\r\n            setView(\"sidebar\")\r\n        }\r\n    }\r\n\r\n    const openStats = (idx) => {\r\n        if(statInterval) {\r\n            clearInterval(statInterval);\r\n        }\r\n        const interval = setInterval(async ()=>{\r\n            let messages=['',''];\r\n            if(RTCObjects.current[idx] && RTCObjects.current[idx].pcLocal){\r\n                const localStat = await RTCObjects.current[idx].pcLocal.getStats(null).then(\r\n                    results=>results, err => err.toString()\r\n                )\r\n                messages[0] = localStat;\r\n            }\r\n            if(RTCObjects.current[idx] && RTCObjects.current[idx].pcRemote){\r\n                const remoteStat = await RTCObjects.current[idx].pcRemote.getStats(null).then(\r\n                    results=>results, err => err.toString()\r\n                )\r\n                messages[1] = remoteStat;\r\n            }\r\n            setStatMessages(messages);\r\n        },1000);\r\n        setStatInterval(interval);\r\n        setStatsIsOpen(true);\r\n    }\r\n\r\n    const closeStats = () => {\r\n        clearInterval(statInterval);\r\n        setStatsIsOpen(false);\r\n        setStatInterval(null);\r\n    }\r\n\r\n    return(\r\n        <Test\r\n            audio={audio}\r\n            video={video}\r\n            setConnections={(val)=>adjustConnection(val)}\r\n            toggleAudio={toggleAudio}\r\n            toggleVideo={toggleVideo}\r\n            toggleView={toggleView}\r\n            hangup={()=>hangup(true)}\r\n            connections={connections}\r\n            localStreamRef={localStream}\r\n            remoteStreamRefs={remoteRefs}\r\n            statsIsOpen={statsIsOpen}\r\n            openStats={(idx)=>openStats(idx)}\r\n            closeStats={closeStats}\r\n            statMessages={statMessages}\r\n            isSender={isSender}\r\n            setIsSender={setIsSender}\r\n        />\r\n    );\r\n}\r\n\r\nexport default withRouter(TestForm);","import React from 'react';\r\nimport TestForm from '../containers/TestForm';\r\n\r\nexport default class Test extends React.Component {\r\n\r\n    render() {\r\n        return (\r\n            <TestForm />\r\n        );\r\n    }\r\n}","import { BrowserRouter, Route} from 'react-router-dom'\r\nimport { Home, Test } from './pages';\r\nimport './App.css';\r\n\r\nfunction App() {\r\n  return (\r\n    <BrowserRouter basename={process.env.PUBLIC_URL} hashType=\"noslash\">\r\n      <Route exact path=\"/\" component={Home}/>\r\n      <Route exact path=\"/test\" component={Test}/>\r\n    </BrowserRouter>\r\n  );\r\n}\r\n\r\nexport default App;","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import { combineReducers } from 'redux';\r\nimport rtc from './rtc';\r\n\r\n\r\nconst appReducer = combineReducers({\r\n  rtc,\r\n});\r\n\r\nconst rootReducer = (state, action) => {\r\n  return appReducer(state, action)\r\n}\r\n\r\nexport default rootReducer;\r\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nimport { Provider } from 'react-redux';\nimport { createStore } from 'redux';\nimport rootReducer from './modules';\nimport { composeWithDevTools } from 'redux-devtools-extension';\n\nconst store = createStore(\n  rootReducer, composeWithDevTools()\n);\n\nReactDOM.render(\n  <Provider store={store}>\n    <React.StrictMode>\n      <App />\n    </React.StrictMode>\n  </Provider>,\n  document.getElementById('root')\n);\n\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}